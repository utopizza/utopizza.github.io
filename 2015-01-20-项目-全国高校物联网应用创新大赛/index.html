<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>全国高校物联网应用创新大赛 - Utopizza</title>
        <meta name="Description" content="About LoveIt Theme"><meta property="og:title" content="全国高校物联网应用创新大赛" />
<meta property="og:description" content="一、简介
参赛作品是“基于物联网的车辆事故智能报警系统”，它对车辆运行情况进行实时监控。一旦发生车辆事故导致安全气囊打开时，系统便会检测到这一状态，并立即获取事故的定位信息、人员信息并进行自动报警。当交警服务中心接收到报警电话和相关信息后，就会立即通知离事故发生地最近的医院前往救援。
系统工作流程：
1、 当车载客户端监测到安全气囊打开后，它先从 OBD 系统中读取出车辆故障码等车辆信息，记录到单片机内存中，然后启动蓝牙模块，把车辆信息发送到手机客户端；
2、当手机客户端收到车辆故障码后， (1)、启动第一重自动报警：从手机内存卡读出驾车人员信息，启动 GPS 对车辆进行定位读出车辆经纬度，然后把车辆信息、人员信息、定位信息一并通过 GPRS 发送到交警信息中心服务器； (2)、启动第二重自动报警：调用手机的拨号功能，自动拨打 110 报警电话； (3)、当手机报警功能被触发后， 手机开始倒计时 15 秒。用户可以在 15 秒内点击取消按钮中断报警， 否则在计时结束后执行报警任务。
3、当交警信息中心服务器收到手机发送过来的报警信息后，会马上把报警信息显示在屏幕上，并响起警铃，通知交警人员，前往事故现在进行处理。
二、实现
我负责开发的部分是 Server 端的“交警信息中心”网站，和 Client 端的“EmergencyCall”安卓 App。
1、Server 端
基于 .NET 的 WebService 框架，采用 Model -&gt; DAL -&gt; BLL 三层架构。Server 端的主要功能是：提供 WebService 方法给安卓 客户端调用，接收其发送过来的数据，经过处理后插入数据库，最后显示到网页上。
Server 端主要的两个文件是：网站主页 TICSystemDefault.aspx 和 WebService 接口 TICSystemWebService.asmx。网站主页每3秒自动刷新一次，把所有数据即时地显示到网页上。WebService 接口负责和安卓端数据交互。其他文件分别实现解析Json字符串并转化成Model、操作数据库、绑定数据到网页等等。
其中提供给安卓端调用的 WebService 方法：
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25  // webservice方法 [WebMethod] public int AddAccidentInfo(string JasonAccidentInfo) { AccidentInfoModel AccidentInfo = ModelJsonChange&lt;AccidentInfoModel&gt;." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://utopizza.github.io/2015-01-20-%E9%A1%B9%E7%9B%AE-%E5%85%A8%E5%9B%BD%E9%AB%98%E6%A0%A1%E7%89%A9%E8%81%94%E7%BD%91%E5%BA%94%E7%94%A8%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B/" /><meta property="og:image" content="https://utopizza.github.io/logo.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2015-01-20T22:14:40&#43;00:00" />
<meta property="article:modified_time" content="2015-01-20T22:14:40&#43;00:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://utopizza.github.io/logo.png"/>

<meta name="twitter:title" content="全国高校物联网应用创新大赛"/>
<meta name="twitter:description" content="一、简介
参赛作品是“基于物联网的车辆事故智能报警系统”，它对车辆运行情况进行实时监控。一旦发生车辆事故导致安全气囊打开时，系统便会检测到这一状态，并立即获取事故的定位信息、人员信息并进行自动报警。当交警服务中心接收到报警电话和相关信息后，就会立即通知离事故发生地最近的医院前往救援。
系统工作流程：
1、 当车载客户端监测到安全气囊打开后，它先从 OBD 系统中读取出车辆故障码等车辆信息，记录到单片机内存中，然后启动蓝牙模块，把车辆信息发送到手机客户端；
2、当手机客户端收到车辆故障码后， (1)、启动第一重自动报警：从手机内存卡读出驾车人员信息，启动 GPS 对车辆进行定位读出车辆经纬度，然后把车辆信息、人员信息、定位信息一并通过 GPRS 发送到交警信息中心服务器； (2)、启动第二重自动报警：调用手机的拨号功能，自动拨打 110 报警电话； (3)、当手机报警功能被触发后， 手机开始倒计时 15 秒。用户可以在 15 秒内点击取消按钮中断报警， 否则在计时结束后执行报警任务。
3、当交警信息中心服务器收到手机发送过来的报警信息后，会马上把报警信息显示在屏幕上，并响起警铃，通知交警人员，前往事故现在进行处理。
二、实现
我负责开发的部分是 Server 端的“交警信息中心”网站，和 Client 端的“EmergencyCall”安卓 App。
1、Server 端
基于 .NET 的 WebService 框架，采用 Model -&gt; DAL -&gt; BLL 三层架构。Server 端的主要功能是：提供 WebService 方法给安卓 客户端调用，接收其发送过来的数据，经过处理后插入数据库，最后显示到网页上。
Server 端主要的两个文件是：网站主页 TICSystemDefault.aspx 和 WebService 接口 TICSystemWebService.asmx。网站主页每3秒自动刷新一次，把所有数据即时地显示到网页上。WebService 接口负责和安卓端数据交互。其他文件分别实现解析Json字符串并转化成Model、操作数据库、绑定数据到网页等等。
其中提供给安卓端调用的 WebService 方法：
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25  // webservice方法 [WebMethod] public int AddAccidentInfo(string JasonAccidentInfo) { AccidentInfoModel AccidentInfo = ModelJsonChange&lt;AccidentInfoModel&gt;."/>
<meta name="application-name" content="Utopizza">
<meta name="apple-mobile-web-app-title" content="Utopizza"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://utopizza.github.io/2015-01-20-%E9%A1%B9%E7%9B%AE-%E5%85%A8%E5%9B%BD%E9%AB%98%E6%A0%A1%E7%89%A9%E8%81%94%E7%BD%91%E5%BA%94%E7%94%A8%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B/" /><link rel="prev" href="https://utopizza.github.io/2014-12-28-%E6%8A%80%E6%9C%AF%E7%AC%94%E8%AE%B09/" /><link rel="next" href="https://utopizza.github.io/2015-04-20-%E9%A1%B9%E7%9B%AE-%E7%BE%8E%E5%9B%BD%E5%A4%A7%E5%AD%A6%E7%94%9F%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1%E7%AB%9E%E8%B5%9B/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "全国高校物联网应用创新大赛",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/utopizza.github.io\/2015-01-20-%E9%A1%B9%E7%9B%AE-%E5%85%A8%E5%9B%BD%E9%AB%98%E6%A0%A1%E7%89%A9%E8%81%94%E7%BD%91%E5%BA%94%E7%94%A8%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B\/"
        },"image": {
                "@type": "ImageObject",
                "url": "https:\/\/utopizza.github.io\/cover.png",
                "width":  800 ,
                "height":  600 
            },"genre": "posts","wordcount":  1049 ,
        "url": "https:\/\/utopizza.github.io\/2015-01-20-%E9%A1%B9%E7%9B%AE-%E5%85%A8%E5%9B%BD%E9%AB%98%E6%A0%A1%E7%89%A9%E8%81%94%E7%BD%91%E5%BA%94%E7%94%A8%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B\/","datePublished": "2015-01-20T22:14:40+00:00","dateModified": "2015-01-20T22:14:40+00:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
                "@type": "Organization",
                "name": "",
                "logo": {
                "@type": "ImageObject",
                "url": "https:\/\/utopizza.github.io\/logo.png",
                "width":  127 ,
                "height":  40 
                }
            },"author": {
                "@type": "Person",
                "name": "yusheng"
            },"description": ""
    }
    </script></head>
    <body><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Utopizza"><span class="header-title-pre"><i class='far fa-kiss-wink-heart fa-fw'></i></span>Utopizza</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="https://github.com/utopizza" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i>  </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Utopizza"><span class="header-title-pre"><i class='far fa-kiss-wink-heart fa-fw'></i></span>Utopizza</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="https://github.com/utopizza" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">全国高校物联网应用创新大赛</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i>yusheng</a></span>&nbsp;
                    <span class="post-category">included in<a href="/categories/projects/">
                                <i class="far fa-folder fa-fw"></i>Projects
                            </a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i><time datetime=2015-01-20>2015-01-20</time>&nbsp;
                <i class="fas fa-pencil-alt fa-fw"></i>about 1049 words&nbsp;
                <i class="far fa-clock fa-fw"></i>5 min&nbsp;</div>
        </div><div class="details toc" id="toc-static">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents"></nav></div>
            </div><div class="content" id="content"><p>一、简介</p>
<p>参赛作品是“基于物联网的车辆事故智能报警系统”，它对车辆运行情况进行实时监控。一旦发生车辆事故导致安全气囊打开时，系统便会检测到这一状态，并立即获取事故的定位信息、人员信息并进行自动报警。当交警服务中心接收到报警电话和相关信息后，就会立即通知离事故发生地最近的医院前往救援。</p>
<p><img
        class="lazyload"
        src="/svg/loading/small.min.svg"
        data-src="/2015-01-20-%e9%a1%b9%e7%9b%ae-%e5%85%a8%e5%9b%bd%e9%ab%98%e6%a0%a1%e7%89%a9%e8%81%94%e7%bd%91%e5%ba%94%e7%94%a8%e5%88%9b%e6%96%b0%e5%a4%a7%e8%b5%9b/%e7%b3%bb%e7%bb%9f%e6%b5%81%e7%a8%8b%e5%9b%be.png"
        data-srcset="/2015-01-20-%e9%a1%b9%e7%9b%ae-%e5%85%a8%e5%9b%bd%e9%ab%98%e6%a0%a1%e7%89%a9%e8%81%94%e7%bd%91%e5%ba%94%e7%94%a8%e5%88%9b%e6%96%b0%e5%a4%a7%e8%b5%9b/%e7%b3%bb%e7%bb%9f%e6%b5%81%e7%a8%8b%e5%9b%be.png, /2015-01-20-%e9%a1%b9%e7%9b%ae-%e5%85%a8%e5%9b%bd%e9%ab%98%e6%a0%a1%e7%89%a9%e8%81%94%e7%bd%91%e5%ba%94%e7%94%a8%e5%88%9b%e6%96%b0%e5%a4%a7%e8%b5%9b/%e7%b3%bb%e7%bb%9f%e6%b5%81%e7%a8%8b%e5%9b%be.png 1.5x, /2015-01-20-%e9%a1%b9%e7%9b%ae-%e5%85%a8%e5%9b%bd%e9%ab%98%e6%a0%a1%e7%89%a9%e8%81%94%e7%bd%91%e5%ba%94%e7%94%a8%e5%88%9b%e6%96%b0%e5%a4%a7%e8%b5%9b/%e7%b3%bb%e7%bb%9f%e6%b5%81%e7%a8%8b%e5%9b%be.png 2x"
        data-sizes="auto"
        alt="/2015-01-20-项目-全国高校物联网应用创新大赛/系统流程图.png"
        title="/2015-01-20-项目-全国高校物联网应用创新大赛/系统流程图.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading/small.min.svg"
        data-src="/2015-01-20-%e9%a1%b9%e7%9b%ae-%e5%85%a8%e5%9b%bd%e9%ab%98%e6%a0%a1%e7%89%a9%e8%81%94%e7%bd%91%e5%ba%94%e7%94%a8%e5%88%9b%e6%96%b0%e5%a4%a7%e8%b5%9b/%e7%b3%bb%e7%bb%9f%e6%b5%81%e7%a8%8b%e5%9b%be2.png"
        data-srcset="/2015-01-20-%e9%a1%b9%e7%9b%ae-%e5%85%a8%e5%9b%bd%e9%ab%98%e6%a0%a1%e7%89%a9%e8%81%94%e7%bd%91%e5%ba%94%e7%94%a8%e5%88%9b%e6%96%b0%e5%a4%a7%e8%b5%9b/%e7%b3%bb%e7%bb%9f%e6%b5%81%e7%a8%8b%e5%9b%be2.png, /2015-01-20-%e9%a1%b9%e7%9b%ae-%e5%85%a8%e5%9b%bd%e9%ab%98%e6%a0%a1%e7%89%a9%e8%81%94%e7%bd%91%e5%ba%94%e7%94%a8%e5%88%9b%e6%96%b0%e5%a4%a7%e8%b5%9b/%e7%b3%bb%e7%bb%9f%e6%b5%81%e7%a8%8b%e5%9b%be2.png 1.5x, /2015-01-20-%e9%a1%b9%e7%9b%ae-%e5%85%a8%e5%9b%bd%e9%ab%98%e6%a0%a1%e7%89%a9%e8%81%94%e7%bd%91%e5%ba%94%e7%94%a8%e5%88%9b%e6%96%b0%e5%a4%a7%e8%b5%9b/%e7%b3%bb%e7%bb%9f%e6%b5%81%e7%a8%8b%e5%9b%be2.png 2x"
        data-sizes="auto"
        alt="/2015-01-20-项目-全国高校物联网应用创新大赛/系统流程图2.png"
        title="/2015-01-20-项目-全国高校物联网应用创新大赛/系统流程图2.png" /></p>
<p>系统工作流程：</p>
<p>1、 当车载客户端监测到安全气囊打开后，它先从 OBD 系统中读取出车辆故障码等车辆信息，记录到单片机内存中，然后启动蓝牙模块，把车辆信息发送到手机客户端；</p>
<p>2、当手机客户端收到车辆故障码后，
(1)、启动第一重自动报警：从手机内存卡读出驾车人员信息，启动 GPS 对车辆进行定位读出车辆经纬度，然后把车辆信息、人员信息、定位信息一并通过 GPRS 发送到交警信息中心服务器；
(2)、启动第二重自动报警：调用手机的拨号功能，自动拨打 110 报警电话；
(3)、当手机报警功能被触发后， 手机开始倒计时 15 秒。用户可以在 15 秒内点击取消按钮中断报警， 否则在计时结束后执行报警任务。</p>
<p>3、当交警信息中心服务器收到手机发送过来的报警信息后，会马上把报警信息显示在屏幕上，并响起警铃，通知交警人员，前往事故现在进行处理。</p>
<p>二、实现</p>
<p>我负责开发的部分是 Server 端的“交警信息中心”网站，和 Client 端的“EmergencyCall”安卓 App。</p>
<p>1、Server 端</p>
<p>基于 .NET 的 WebService 框架，采用 Model -&gt; DAL -&gt; BLL 三层架构。Server 端的主要功能是：提供 WebService 方法给安卓 客户端调用，接收其发送过来的数据，经过处理后插入数据库，最后显示到网页上。</p>
<p>Server 端主要的两个文件是：网站主页 TICSystemDefault.aspx 和 WebService 接口 TICSystemWebService.asmx。网站主页每3秒自动刷新一次，把所有数据即时地显示到网页上。WebService 接口负责和安卓端数据交互。其他文件分别实现解析Json字符串并转化成Model、操作数据库、绑定数据到网页等等。</p>
<p><img
        class="lazyload"
        src="/svg/loading/small.min.svg"
        data-src="/2015-01-20-%e9%a1%b9%e7%9b%ae-%e5%85%a8%e5%9b%bd%e9%ab%98%e6%a0%a1%e7%89%a9%e8%81%94%e7%bd%91%e5%ba%94%e7%94%a8%e5%88%9b%e6%96%b0%e5%a4%a7%e8%b5%9b/Server%e7%ab%af.png"
        data-srcset="/2015-01-20-%e9%a1%b9%e7%9b%ae-%e5%85%a8%e5%9b%bd%e9%ab%98%e6%a0%a1%e7%89%a9%e8%81%94%e7%bd%91%e5%ba%94%e7%94%a8%e5%88%9b%e6%96%b0%e5%a4%a7%e8%b5%9b/Server%e7%ab%af.png, /2015-01-20-%e9%a1%b9%e7%9b%ae-%e5%85%a8%e5%9b%bd%e9%ab%98%e6%a0%a1%e7%89%a9%e8%81%94%e7%bd%91%e5%ba%94%e7%94%a8%e5%88%9b%e6%96%b0%e5%a4%a7%e8%b5%9b/Server%e7%ab%af.png 1.5x, /2015-01-20-%e9%a1%b9%e7%9b%ae-%e5%85%a8%e5%9b%bd%e9%ab%98%e6%a0%a1%e7%89%a9%e8%81%94%e7%bd%91%e5%ba%94%e7%94%a8%e5%88%9b%e6%96%b0%e5%a4%a7%e8%b5%9b/Server%e7%ab%af.png 2x"
        data-sizes="auto"
        alt="/2015-01-20-项目-全国高校物联网应用创新大赛/Server端.png"
        title="/2015-01-20-项目-全国高校物联网应用创新大赛/Server端.png" /></p>
<p>其中提供给安卓端调用的 WebService 方法：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">// webservice方法
[WebMethod]
public int AddAccidentInfo(string JasonAccidentInfo)
{
    AccidentInfoModel AccidentInfo = ModelJsonChange&lt;AccidentInfoModel&gt;.JsonToModel(JasonAccidentInfo);
    return accidentDal.AddAccidentInfo(AccidentInfo);
}

//Helper类，实现Json和Model的互转
public class ModelJsonChange&lt;T&gt;
{
    //Model转换为Json
    public static string ModelToJson(T model)
    {
        JavaScriptSerializer js = new JavaScriptSerializer();
        return js.Serialize(model);
    }

    //Json转换为Model
    public static T JsonToModel(string json)
    {
        JavaScriptSerializer js = new JavaScriptSerializer();
        return js.Deserialize&lt;T&gt;(json);
    }
}
</code></pre></td></tr></table>
</div>
</div><p>2、Client 端</p>
<p>Client 端的安卓 App 名为“EmergencyCall”。</p>
<p><img
        class="lazyload"
        src="/svg/loading/small.min.svg"
        data-src="/2015-01-20-%e9%a1%b9%e7%9b%ae-%e5%85%a8%e5%9b%bd%e9%ab%98%e6%a0%a1%e7%89%a9%e8%81%94%e7%bd%91%e5%ba%94%e7%94%a8%e5%88%9b%e6%96%b0%e5%a4%a7%e8%b5%9b/MainActivity.png"
        data-srcset="/2015-01-20-%e9%a1%b9%e7%9b%ae-%e5%85%a8%e5%9b%bd%e9%ab%98%e6%a0%a1%e7%89%a9%e8%81%94%e7%bd%91%e5%ba%94%e7%94%a8%e5%88%9b%e6%96%b0%e5%a4%a7%e8%b5%9b/MainActivity.png, /2015-01-20-%e9%a1%b9%e7%9b%ae-%e5%85%a8%e5%9b%bd%e9%ab%98%e6%a0%a1%e7%89%a9%e8%81%94%e7%bd%91%e5%ba%94%e7%94%a8%e5%88%9b%e6%96%b0%e5%a4%a7%e8%b5%9b/MainActivity.png 1.5x, /2015-01-20-%e9%a1%b9%e7%9b%ae-%e5%85%a8%e5%9b%bd%e9%ab%98%e6%a0%a1%e7%89%a9%e8%81%94%e7%bd%91%e5%ba%94%e7%94%a8%e5%88%9b%e6%96%b0%e5%a4%a7%e8%b5%9b/MainActivity.png 2x"
        data-sizes="auto"
        alt="/2015-01-20-项目-全国高校物联网应用创新大赛/MainActivity.png"
        title="/2015-01-20-项目-全国高校物联网应用创新大赛/MainActivity.png" /></p>
<p>其中分为五大功能模块：</p>
<p>(1). SaveActivity：保存、修改用户的个人信息。我使用了SharedPreferences来保存这些数据。SharedPreferences是Android平台上一个轻量级的存储类，用来保存应用的一些常用配置。</p>
<p><img
        class="lazyload"
        src="/svg/loading/small.min.svg"
        data-src="/2015-01-20-%e9%a1%b9%e7%9b%ae-%e5%85%a8%e5%9b%bd%e9%ab%98%e6%a0%a1%e7%89%a9%e8%81%94%e7%bd%91%e5%ba%94%e7%94%a8%e5%88%9b%e6%96%b0%e5%a4%a7%e8%b5%9b/SaveActivity.png"
        data-srcset="/2015-01-20-%e9%a1%b9%e7%9b%ae-%e5%85%a8%e5%9b%bd%e9%ab%98%e6%a0%a1%e7%89%a9%e8%81%94%e7%bd%91%e5%ba%94%e7%94%a8%e5%88%9b%e6%96%b0%e5%a4%a7%e8%b5%9b/SaveActivity.png, /2015-01-20-%e9%a1%b9%e7%9b%ae-%e5%85%a8%e5%9b%bd%e9%ab%98%e6%a0%a1%e7%89%a9%e8%81%94%e7%bd%91%e5%ba%94%e7%94%a8%e5%88%9b%e6%96%b0%e5%a4%a7%e8%b5%9b/SaveActivity.png 1.5x, /2015-01-20-%e9%a1%b9%e7%9b%ae-%e5%85%a8%e5%9b%bd%e9%ab%98%e6%a0%a1%e7%89%a9%e8%81%94%e7%bd%91%e5%ba%94%e7%94%a8%e5%88%9b%e6%96%b0%e5%a4%a7%e8%b5%9b/SaveActivity.png 2x"
        data-sizes="auto"
        alt="/2015-01-20-项目-全国高校物联网应用创新大赛/SaveActivity.png"
        title="/2015-01-20-项目-全国高校物联网应用创新大赛/SaveActivity.png" /></p>
<p>关键代码（为节省篇幅，以下均省略 OnCreate、setContentView、addActivity、findViewById 等基本的常用代码，只显示实现某功能的关键代码）：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">// 声明
private EditText EditText_userName;// 姓名
private EditText EditText_userPhone;// 电话
private EditText EditText_userCar;// 车牌
private SharedPreferences sharedPrefrences;
private Editor editor;
private static final String FILENAME = &#34;filename&#34;;// 要存储的文件名

// 进入页面时，将已经保存在文件中的内容取出，显示到三个文本框中
sharedPrefrences = this.getSharedPreferences(FILENAME, MODE_PRIVATE);
EditText_userName.setText(sharedPrefrences.getString(&#34;userName&#34;, &#34;&#34;));
EditText_userPhone.setText(sharedPrefrences.getString(&#34;userPhone&#34;, &#34;&#34;));
EditText_userCar.setText(sharedPrefrences.getString(&#34;userCar&#34;, &#34;&#34;));

// 保存按钮
savebutton.setOnClickListener(new View.OnClickListener() {
	@Override
	public void onClick(View v) {
		editor = getSharedPreferences(FILENAME, MODE_PRIVATE).edit();
		editor.putString(&#34;userName&#34;, EditText_userName.getText().toString());
		editor.putString(&#34;userPhone&#34;, EditText_userPhone.getText().toString());
		editor.putString(&#34;userCar&#34;, EditText_userCar.getText().toString());
		editor.commit();
		Intent intent = new Intent();
		intent.setClass(SaveActivity.this, MainActivity.class);
		startActivity(intent);
	}
});
</code></pre></td></tr></table>
</div>
</div><p>(2). BlueToothActivity：蓝牙连接，使手机通过蓝牙与车上的硬件模块通讯。</p>
<p><img
        class="lazyload"
        src="/svg/loading/small.min.svg"
        data-src="/2015-01-20-%e9%a1%b9%e7%9b%ae-%e5%85%a8%e5%9b%bd%e9%ab%98%e6%a0%a1%e7%89%a9%e8%81%94%e7%bd%91%e5%ba%94%e7%94%a8%e5%88%9b%e6%96%b0%e5%a4%a7%e8%b5%9b/BlueToothActivity.png"
        data-srcset="/2015-01-20-%e9%a1%b9%e7%9b%ae-%e5%85%a8%e5%9b%bd%e9%ab%98%e6%a0%a1%e7%89%a9%e8%81%94%e7%bd%91%e5%ba%94%e7%94%a8%e5%88%9b%e6%96%b0%e5%a4%a7%e8%b5%9b/BlueToothActivity.png, /2015-01-20-%e9%a1%b9%e7%9b%ae-%e5%85%a8%e5%9b%bd%e9%ab%98%e6%a0%a1%e7%89%a9%e8%81%94%e7%bd%91%e5%ba%94%e7%94%a8%e5%88%9b%e6%96%b0%e5%a4%a7%e8%b5%9b/BlueToothActivity.png 1.5x, /2015-01-20-%e9%a1%b9%e7%9b%ae-%e5%85%a8%e5%9b%bd%e9%ab%98%e6%a0%a1%e7%89%a9%e8%81%94%e7%bd%91%e5%ba%94%e7%94%a8%e5%88%9b%e6%96%b0%e5%a4%a7%e8%b5%9b/BlueToothActivity.png 2x"
        data-sizes="auto"
        alt="/2015-01-20-项目-全国高校物联网应用创新大赛/BlueToothActivity.png"
        title="/2015-01-20-项目-全国高校物联网应用创新大赛/BlueToothActivity.png" /></p>
<p>关键代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">// 通过蓝牙连接硬件
BluetoothAdapter btAdapt = BluetoothAdapter.getDefaultAdapter();
BluetoothDevice btDev = btAdapt.getRemoteDevice(address);// &#34;00:11:00:18:05:45&#34;
Method m = btDev.getClass().getMethod(&#34;createRfcommSocket&#34;, new Class[] { int.class });
BluetoothSocket btSocket = (BluetoothSocket) m.invoke(btDev, Integer.valueOf(1));
try {
	btSocket.connect();
	Log.e(TAG, &#34; BT connection established, data transfer link open.&#34;);
	Toast.makeText(testBlueTooth.this, &#34;连接成功&#34;, Toast.LENGTH_SHORT).show();
	
	// 进入护航界面
	Intent intent = new Intent();
	intent.setClass(testBlueTooth.this, DisplayActivity.class);
	startActivity(intent);
	
} catch (IOException e) {
	Log.e(TAG, &#34; Connection failed.&#34;, e);
	setTitle(&#34;连接失败..&#34;);
}
</code></pre></td></tr></table>
</div>
</div><p>(3). DisplayActivity：连接成功后，手机将一直监控车载硬件模块的状态，接收硬件模块发送过来的状态码。</p>
<p><img
        class="lazyload"
        src="/svg/loading/small.min.svg"
        data-src="/2015-01-20-%e9%a1%b9%e7%9b%ae-%e5%85%a8%e5%9b%bd%e9%ab%98%e6%a0%a1%e7%89%a9%e8%81%94%e7%bd%91%e5%ba%94%e7%94%a8%e5%88%9b%e6%96%b0%e5%a4%a7%e8%b5%9b/DisplayActivity.png"
        data-srcset="/2015-01-20-%e9%a1%b9%e7%9b%ae-%e5%85%a8%e5%9b%bd%e9%ab%98%e6%a0%a1%e7%89%a9%e8%81%94%e7%bd%91%e5%ba%94%e7%94%a8%e5%88%9b%e6%96%b0%e5%a4%a7%e8%b5%9b/DisplayActivity.png, /2015-01-20-%e9%a1%b9%e7%9b%ae-%e5%85%a8%e5%9b%bd%e9%ab%98%e6%a0%a1%e7%89%a9%e8%81%94%e7%bd%91%e5%ba%94%e7%94%a8%e5%88%9b%e6%96%b0%e5%a4%a7%e8%b5%9b/DisplayActivity.png 1.5x, /2015-01-20-%e9%a1%b9%e7%9b%ae-%e5%85%a8%e5%9b%bd%e9%ab%98%e6%a0%a1%e7%89%a9%e8%81%94%e7%bd%91%e5%ba%94%e7%94%a8%e5%88%9b%e6%96%b0%e5%a4%a7%e8%b5%9b/DisplayActivity.png 2x"
        data-sizes="auto"
        alt="/2015-01-20-项目-全国高校物联网应用创新大赛/DisplayActivity.png"
        title="/2015-01-20-项目-全国高校物联网应用创新大赛/DisplayActivity.png" /></p>
<p>关键代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">// 监听车载硬件模块发送过来的消息
ConnectedThread manageThread = new ConnectedThread();
Handler mHandler = new MyHandler();
manageThread.Start();
public ConnectedThread() {
	isRecording = false;
	this.wait = 50;
	thread = new Thread(new ReadRunnable());
}
private class ReadRunnable implements Runnable {
	public void run() {
		while (isRecording) {

			//从蓝牙端口获取接收到的消息
			try {
				inStream = testBlueTooth.btSocket.getInputStream();
			} catch (IOException e) {}

			// 处理获取的消息，设置长度为20
			int length = 20;
			byte[] temp = new byte[length];
			if (inStream != null) {
				try {
					int len = inStream.read(temp, 0, length - 1);
					Log.e(&#34;available&#34;, String.valueOf(len));
					if (len &gt; 0) {
						byte[] btBuf = new byte[len];
						System.arraycopy(temp, 0, btBuf, 0, btBuf.length);
						String readStr1 = new String(btBuf, encodeType);
						// 如果收到非空数据，说明事故发生，发送“01”给mHandler
						mHandler.obtainMessage(01, len, -1, readStr1).sendToTarget();
					}
					Thread.sleep(wait);
				} catch (Exception e) {
					// 否则发送“00”，表示没有事故发生(这样好像逻辑有点问题)
					mHandler.sendEmptyMessage(00);
				}
			}

		}
	}
}

// 接收到状态码后的后续处理
private class MyHandler extends Handler {
	@Override
	public void dispatchMessage(Message msg) {
		String info = (String) msg.obj;
		if (StopFlag) {
			if (info.equals(&#34;01&#34;)) {
				
				StopFlag=false;
				
				// 报警
				Intent intent = new Intent();
				intent.setClass(DisplayActivity.this, PostActivity.class);
				startActivity(intent);
				// finish();
			}
		}
	}
}
</code></pre></td></tr></table>
</div>
</div><p>(4). PostActivity：进入事故报警流程，获取用户的个人信息、地理位置信息和当前时间，然后通过 GPRS 发送到交警信息中心网站。发送的数据格式是 Json。</p>
<p><img
        class="lazyload"
        src="/svg/loading/small.min.svg"
        data-src="/2015-01-20-%e9%a1%b9%e7%9b%ae-%e5%85%a8%e5%9b%bd%e9%ab%98%e6%a0%a1%e7%89%a9%e8%81%94%e7%bd%91%e5%ba%94%e7%94%a8%e5%88%9b%e6%96%b0%e5%a4%a7%e8%b5%9b/PostActivity.png"
        data-srcset="/2015-01-20-%e9%a1%b9%e7%9b%ae-%e5%85%a8%e5%9b%bd%e9%ab%98%e6%a0%a1%e7%89%a9%e8%81%94%e7%bd%91%e5%ba%94%e7%94%a8%e5%88%9b%e6%96%b0%e5%a4%a7%e8%b5%9b/PostActivity.png, /2015-01-20-%e9%a1%b9%e7%9b%ae-%e5%85%a8%e5%9b%bd%e9%ab%98%e6%a0%a1%e7%89%a9%e8%81%94%e7%bd%91%e5%ba%94%e7%94%a8%e5%88%9b%e6%96%b0%e5%a4%a7%e8%b5%9b/PostActivity.png 1.5x, /2015-01-20-%e9%a1%b9%e7%9b%ae-%e5%85%a8%e5%9b%bd%e9%ab%98%e6%a0%a1%e7%89%a9%e8%81%94%e7%bd%91%e5%ba%94%e7%94%a8%e5%88%9b%e6%96%b0%e5%a4%a7%e8%b5%9b/PostActivity.png 2x"
        data-sizes="auto"
        alt="/2015-01-20-项目-全国高校物联网应用创新大赛/PostActivity.png"
        title="/2015-01-20-项目-全国高校物联网应用创新大赛/PostActivity.png" /></p>
<p>具体工作流程：启动线程 time_runnable 计时 -&gt; 计时结束，发送报警信息给 time_handler -&gt; time_handler 转发报警信息给 http_handler -&gt; http_handler 启动线程 http_runnable 执行 http 报警。HttpPost 用到了外部包 ksoap2 。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">import android.location.Location;
import android.location.LocationListener;
import android.location.LocationManager;
import org.json.JSONException;
import org.json.JSONObject;
import org.ksoap2.SoapEnvelope;
import org.ksoap2.serialization.SoapObject;
import org.ksoap2.serialization.SoapSerializationEnvelope;
import org.ksoap2.transport.HttpTransportSE;

// 获取当前时间
public String GetNowDateTime() {
	SimpleDateFormat sDateFormat = new SimpleDateFormat(&#34;yyyy-MM-dd HH:mm:ss&#34;);
	String date = sDateFormat.format(new java.util.Date());
	return date;
}

// 获取地理位置
public String GetLocation() {

	LocationManager locationManager = (LocationManager) getSystemService(LOCATION_SERVICE);
	Criteria criteria = new Criteria();
	criteria.setAccuracy(Criteria.ACCURACY_COARSE);
	criteria.setAltitudeRequired(false);
	criteria.setBearingRequired(false);
	criteria.setCostAllowed(true);
	criteria.setPowerRequirement(Criteria.POWER_HIGH);
	criteria.setSpeedRequired(false);

	String currentProvider = locationManager.getBestProvider(criteria, true);
	Location currentLocation = locationManager.getLastKnownLocation(currentProvider);
	if (currentLocation == null) {
		locationManager.requestLocationUpdates(currentProvider, 0, 0, locationListener);
	}
	while (true) {
		currentLocation = locationManager.getLastKnownLocation(currentProvider);
		if (currentLocation != null) {
			Log.d(&#34;Location&#34;, &#34;Latitude: &#34; + currentLocation.getLatitude());
			Log.d(&#34;Location&#34;, &#34;Longitude: &#34; + currentLocation.getLongitude());
			break;
		} else {
			Log.d(&#34;Location&#34;, &#34;Latitude: &#34; + 0);
			Log.d(&#34;Location&#34;, &#34;Longitude: &#34; + 0);
		}
		try {
			Thread.sleep(1000);
		} catch (InterruptedException e) {
			Log.e(&#34;Location&#34;, e.getMessage());
		}
	}

	String userLocation = &#34;经度&#34; + currentLocation.getLongitude() + &#34;；纬度&#34; + currentLocation.getLatitude();
	return userLocation;
}
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">// time_runnable线程：计时15秒，5秒后给time_handler发送信息
Runnable time_runnable = new Runnable() {
    @Override
    public void run() {
        try {
            Thread.sleep(15000);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        Message message = new Message();
        time_handler.sendMessage(message);
    }
};

// http_runnable线程：发送Http报警
Runnable http_runnable = new Runnable() {
    @Override
    public void run() {
        String AccidentTime = GetNowDateTime();
        String AccidentPlace = GetLocation();
        String PersonName = sharedPrefrences.getString(&#34;userName&#34;, &#34;&#34;);
        String PersonPhone = sharedPrefrences.getString(&#34;userPhone&#34;, &#34;&#34;);
        String CarNumber = sharedPrefrences.getString(&#34;userCar&#34;, &#34;&#34;);
        //发送
        HttpPost(AccidentTime, AccidentPlace, PersonName, PersonPhone, CarNumber);
    }
};

// 启动time_runnable（在OnCreate中）
new Thread(time_runnable).start();

// 计时结束，给http_handler转发报警信息
time_handler = new Handler() {
	@Override
	public void handleMessage(Message msg) {
		if (IsPost) {
			
			IsPost = false;
			time_runnable = null;
			
			// 转发报警信息给http_handler
			Message message = new Message();
			http_handler.sendMessage(message);

			// 跳转到拨号报警页面
			Intent intent = new Intent();
			intent.setClass(PostActivity.this, PhoneActivity.class);
			startActivity(intent);
			//finish();
		}
	}
};

// 启动线程http_runnable，执行http报警
Handler http_handler = new Handler() {
    @Override
    public void handleMessage(Message msg) {
        super.handleMessage(msg);
        new Thread(http_runnable).start();
    }
};
</code></pre></td></tr></table>
</div>
</div><p>(5). PhoneActivity：同样倒计时15秒，计时结束后自动拨号报警。</p>
<p><img
        class="lazyload"
        src="/svg/loading/small.min.svg"
        data-src="/2015-01-20-%e9%a1%b9%e7%9b%ae-%e5%85%a8%e5%9b%bd%e9%ab%98%e6%a0%a1%e7%89%a9%e8%81%94%e7%bd%91%e5%ba%94%e7%94%a8%e5%88%9b%e6%96%b0%e5%a4%a7%e8%b5%9b/PhoneActivity.png"
        data-srcset="/2015-01-20-%e9%a1%b9%e7%9b%ae-%e5%85%a8%e5%9b%bd%e9%ab%98%e6%a0%a1%e7%89%a9%e8%81%94%e7%bd%91%e5%ba%94%e7%94%a8%e5%88%9b%e6%96%b0%e5%a4%a7%e8%b5%9b/PhoneActivity.png, /2015-01-20-%e9%a1%b9%e7%9b%ae-%e5%85%a8%e5%9b%bd%e9%ab%98%e6%a0%a1%e7%89%a9%e8%81%94%e7%bd%91%e5%ba%94%e7%94%a8%e5%88%9b%e6%96%b0%e5%a4%a7%e8%b5%9b/PhoneActivity.png 1.5x, /2015-01-20-%e9%a1%b9%e7%9b%ae-%e5%85%a8%e5%9b%bd%e9%ab%98%e6%a0%a1%e7%89%a9%e8%81%94%e7%bd%91%e5%ba%94%e7%94%a8%e5%88%9b%e6%96%b0%e5%a4%a7%e8%b5%9b/PhoneActivity.png 2x"
        data-sizes="auto"
        alt="/2015-01-20-项目-全国高校物联网应用创新大赛/PhoneActivity.png"
        title="/2015-01-20-项目-全国高校物联网应用创新大赛/PhoneActivity.png" /></p>
<p>关键代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">// 启动子线程开始计时
new Thread(time_runnable).start();

// 计时结束，进行拨号报警
time_handler = new Handler() {
	@Override
	public void handleMessage(Message msg) {
		if (IsPhone) {
			
			IsPhone = false;
			time_runnable = null;
			
			// 拨打报警电话
			Intent intent = new Intent(Intent.ACTION_CALL, Uri.parse(&#34;tel:110&#34;));
			PhoneActivity.this.startActivity(intent);
			
			MyApplication.getInstance().exit();
			//finish();
		}
	}
};
</code></pre></td></tr></table>
</div>
</div><p>3、车载硬件模块</p>
<p>这部分是做硬件的同学实现的，安装在车辆的OBD接口上面，不断地给车辆发送查询命令，查询安全气囊的状态码，如果发现安全气囊打开了，那么断定发生了严重事故，立刻通过蓝牙模块发送报警信息给用户的手机，以启动后续的自动报警流程。由于实验条件和时间的限制，目前只实现了简单版。</p>
<p><img
        class="lazyload"
        src="/svg/loading/small.min.svg"
        data-src="/2015-01-20-%e9%a1%b9%e7%9b%ae-%e5%85%a8%e5%9b%bd%e9%ab%98%e6%a0%a1%e7%89%a9%e8%81%94%e7%bd%91%e5%ba%94%e7%94%a8%e5%88%9b%e6%96%b0%e5%a4%a7%e8%b5%9b/%e8%bd%a6%e8%bd%bd%e7%a1%ac%e4%bb%b6%e6%a8%a1%e5%9d%97.jpg"
        data-srcset="/2015-01-20-%e9%a1%b9%e7%9b%ae-%e5%85%a8%e5%9b%bd%e9%ab%98%e6%a0%a1%e7%89%a9%e8%81%94%e7%bd%91%e5%ba%94%e7%94%a8%e5%88%9b%e6%96%b0%e5%a4%a7%e8%b5%9b/%e8%bd%a6%e8%bd%bd%e7%a1%ac%e4%bb%b6%e6%a8%a1%e5%9d%97.jpg, /2015-01-20-%e9%a1%b9%e7%9b%ae-%e5%85%a8%e5%9b%bd%e9%ab%98%e6%a0%a1%e7%89%a9%e8%81%94%e7%bd%91%e5%ba%94%e7%94%a8%e5%88%9b%e6%96%b0%e5%a4%a7%e8%b5%9b/%e8%bd%a6%e8%bd%bd%e7%a1%ac%e4%bb%b6%e6%a8%a1%e5%9d%97.jpg 1.5x, /2015-01-20-%e9%a1%b9%e7%9b%ae-%e5%85%a8%e5%9b%bd%e9%ab%98%e6%a0%a1%e7%89%a9%e8%81%94%e7%bd%91%e5%ba%94%e7%94%a8%e5%88%9b%e6%96%b0%e5%a4%a7%e8%b5%9b/%e8%bd%a6%e8%bd%bd%e7%a1%ac%e4%bb%b6%e6%a8%a1%e5%9d%97.jpg 2x"
        data-sizes="auto"
        alt="/2015-01-20-项目-全国高校物联网应用创新大赛/车载硬件模块.jpg"
        title="/2015-01-20-项目-全国高校物联网应用创新大赛/车载硬件模块.jpg" /></p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>The article was updated on 2015-01-20</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/2015-01-20-%E9%A1%B9%E7%9B%AE-%E5%85%A8%E5%9B%BD%E9%AB%98%E6%A0%A1%E7%89%A9%E8%81%94%E7%BD%91%E5%BA%94%E7%94%A8%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B/index.md" target="_blank">Read Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://utopizza.github.io/2015-01-20-%E9%A1%B9%E7%9B%AE-%E5%85%A8%E5%9B%BD%E9%AB%98%E6%A0%A1%E7%89%A9%E8%81%94%E7%BD%91%E5%BA%94%E7%94%A8%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B/" data-title="全国高校物联网应用创新大赛"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://utopizza.github.io/2015-01-20-%E9%A1%B9%E7%9B%AE-%E5%85%A8%E5%9B%BD%E9%AB%98%E6%A0%A1%E7%89%A9%E8%81%94%E7%BD%91%E5%BA%94%E7%94%A8%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B/"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="Share on WhatsApp" data-sharer="whatsapp" data-url="https://utopizza.github.io/2015-01-20-%E9%A1%B9%E7%9B%AE-%E5%85%A8%E5%9B%BD%E9%AB%98%E6%A0%A1%E7%89%A9%E8%81%94%E7%BD%91%E5%BA%94%E7%94%A8%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B/" data-title="全国高校物联网应用创新大赛" data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="https://utopizza.github.io/2015-01-20-%E9%A1%B9%E7%9B%AE-%E5%85%A8%E5%9B%BD%E9%AB%98%E6%A0%A1%E7%89%A9%E8%81%94%E7%BD%91%E5%BA%94%E7%94%A8%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B/" data-title="全国高校物联网应用创新大赛"><i class="fab fa-line fa-fw"></i></a><a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="https://utopizza.github.io/2015-01-20-%E9%A1%B9%E7%9B%AE-%E5%85%A8%E5%9B%BD%E9%AB%98%E6%A0%A1%E7%89%A9%E8%81%94%E7%BD%91%E5%BA%94%E7%94%A8%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B/" data-title="全国高校物联网应用创新大赛"><i class="fab fa-weibo fa-fw"></i></a><a href="javascript:void(0);" title="Share on Myspace" data-sharer="myspace" data-url="https://utopizza.github.io/2015-01-20-%E9%A1%B9%E7%9B%AE-%E5%85%A8%E5%9B%BD%E9%AB%98%E6%A0%A1%E7%89%A9%E8%81%94%E7%BD%91%E5%BA%94%E7%94%A8%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B/" data-title="全国高校物联网应用创新大赛" data-description=""><i data-svg-src="/lib/simple-icons/icons/myspace.min.svg"></i></a><a href="javascript:void(0);" title="Share on Blogger" data-sharer="blogger" data-url="https://utopizza.github.io/2015-01-20-%E9%A1%B9%E7%9B%AE-%E5%85%A8%E5%9B%BD%E9%AB%98%E6%A0%A1%E7%89%A9%E8%81%94%E7%BD%91%E5%BA%94%E7%94%A8%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B/" data-title="全国高校物联网应用创新大赛" data-description=""><i class="fab fa-blogger fa-fw"></i></a><a href="javascript:void(0);" title="Share on Evernote" data-sharer="evernote" data-url="https://utopizza.github.io/2015-01-20-%E9%A1%B9%E7%9B%AE-%E5%85%A8%E5%9B%BD%E9%AB%98%E6%A0%A1%E7%89%A9%E8%81%94%E7%BD%91%E5%BA%94%E7%94%A8%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B/" data-title="全国高校物联网应用创新大赛"><i class="fab fa-evernote fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/2014-12-28-%E6%8A%80%E6%9C%AF%E7%AC%94%E8%AE%B09/" class="prev" rel="prev" title="技术笔记(9)-MySql语法小结"><i class="fas fa-angle-left fa-fw"></i>技术笔记(9)-MySql语法小结</a>
            <a href="/2015-04-20-%E9%A1%B9%E7%9B%AE-%E7%BE%8E%E5%9B%BD%E5%A4%A7%E5%AD%A6%E7%94%9F%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1%E7%AB%9E%E8%B5%9B/" class="next" rel="next" title="美国大学生数学建模竞赛">美国大学生数学建模竞赛<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.83.1">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.6"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2019 - 2021</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">yusheng</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="stylesheet" href="/lib/katex/copy-tex.min.css"><script type="text/javascript">
    window.config = {"code":{"copyTitle":"Copy to clipboard","maxShownLines":100},"comment":{},"headerMode":{"desktop":"fixed","mobile":"auto"},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false}};
</script><script type="text/javascript" src="https://polyfill.io/v3/polyfill.min.js?features=html5shiv%2CElement.prototype.closest%2CrequestAnimationFrame%2CCustomEvent%2CPromise%2CObject.entries%2CObject.assign%2CObject.values%2Cfetch%2CElement.prototype.after%2CArray.prototype.fill%2CIntersectionObserver%2CArray.from%2CArray.prototype.find%2CMath.sign"></script><script type="text/javascript" src="/lib/smooth-scroll/smooth-scroll.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/object-fit-images/ofi.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js"></script><script type="text/javascript" src="/lib/katex/auto-render.min.js"></script><script type="text/javascript" src="/lib/katex/copy-tex.min.js"></script><script type="text/javascript" src="/lib/katex/mhchem.min.js"></script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>

<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Language" content="en">

    <meta name="author" content="Yusheng Wang">
    <meta name="description" content="一、数据库
1.数据库的选定
use testDB; 2.数据库的创建（后面两个是设置字符集和排序方式）：
create database(if not exist) testDB (character set charset)(collate collation); 3.数据库的删除：
drop database testDB; 4.数据库的更变：
alter database testDB(character set charset)(collate collation); 二、数据表
1.存储引擎（查看存储引擎：show engines）：
 ARCHIVE——插入 BLACKHOLE——删除 EXAMPLE——示例 Falcon——事务 FEDERATED——访问远程数据 InnoDB——外键 MEMORY——内存数据表 MERGE——联合 MyISAM——默认 NDB——MySQL Cluster专用 CSV——使用逗号分隔数据项  2.数据表的创建：
(1).数据表选项（选择存储引擎，否则默认为MyISAM）：
create table testTB( ... ) engine=InnoDB; (2).创建全新的数据表：
create table if not exist testTB( ... ) engine=InnoDB; (3).创建临时数据表：
create temporary table testTB( ... ) (4).使用查询结果或者其它数据表创建数据表：
i.如果要确保新表和原表的数据列的属性、索引都完全一致：
create table testTB like exampleTB; insert into testTB select * from exampleTB; ii.">
    <meta name="keywords" content="blog,developer,personal">

    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="技术笔记(9)-MySql语法小结"/>
<meta name="twitter:description" content="一、数据库
1.数据库的选定
use testDB; 2.数据库的创建（后面两个是设置字符集和排序方式）：
create database(if not exist) testDB (character set charset)(collate collation); 3.数据库的删除：
drop database testDB; 4.数据库的更变：
alter database testDB(character set charset)(collate collation); 二、数据表
1.存储引擎（查看存储引擎：show engines）：
 ARCHIVE——插入 BLACKHOLE——删除 EXAMPLE——示例 Falcon——事务 FEDERATED——访问远程数据 InnoDB——外键 MEMORY——内存数据表 MERGE——联合 MyISAM——默认 NDB——MySQL Cluster专用 CSV——使用逗号分隔数据项  2.数据表的创建：
(1).数据表选项（选择存储引擎，否则默认为MyISAM）：
create table testTB( ... ) engine=InnoDB; (2).创建全新的数据表：
create table if not exist testTB( ... ) engine=InnoDB; (3).创建临时数据表：
create temporary table testTB( ... ) (4).使用查询结果或者其它数据表创建数据表：
i.如果要确保新表和原表的数据列的属性、索引都完全一致：
create table testTB like exampleTB; insert into testTB select * from exampleTB; ii."/>

    <meta property="og:title" content="技术笔记(9)-MySql语法小结" />
<meta property="og:description" content="一、数据库
1.数据库的选定
use testDB; 2.数据库的创建（后面两个是设置字符集和排序方式）：
create database(if not exist) testDB (character set charset)(collate collation); 3.数据库的删除：
drop database testDB; 4.数据库的更变：
alter database testDB(character set charset)(collate collation); 二、数据表
1.存储引擎（查看存储引擎：show engines）：
 ARCHIVE——插入 BLACKHOLE——删除 EXAMPLE——示例 Falcon——事务 FEDERATED——访问远程数据 InnoDB——外键 MEMORY——内存数据表 MERGE——联合 MyISAM——默认 NDB——MySQL Cluster专用 CSV——使用逗号分隔数据项  2.数据表的创建：
(1).数据表选项（选择存储引擎，否则默认为MyISAM）：
create table testTB( ... ) engine=InnoDB; (2).创建全新的数据表：
create table if not exist testTB( ... ) engine=InnoDB; (3).创建临时数据表：
create temporary table testTB( ... ) (4).使用查询结果或者其它数据表创建数据表：
i.如果要确保新表和原表的数据列的属性、索引都完全一致：
create table testTB like exampleTB; insert into testTB select * from exampleTB; ii." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://utopizza.github.io/posts/technique/2014-12-28-%E6%8A%80%E6%9C%AF%E7%AC%94%E8%AE%B09/" />
<meta property="article:published_time" content="2014-12-28T18:44:00+00:00" />
<meta property="article:modified_time" content="2014-12-28T18:44:00+00:00" />


    
      <base href="https://utopizza.github.io/posts/technique/2014-12-28-%E6%8A%80%E6%9C%AF%E7%AC%94%E8%AE%B09/">
    
    <title>
  技术笔记(9)-MySql语法小结 · Utopizza
</title>

    
      <link rel="canonical" href="https://utopizza.github.io/posts/technique/2014-12-28-%E6%8A%80%E6%9C%AF%E7%AC%94%E8%AE%B09/">
    

    <link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather:300,700%7CSource+Code+Pro:400,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.13.0/css/all.css" integrity="sha384-Bfad6CLCknfcloXFOyFnlgtENryhrpZCe29RTifKEixXQZ38WheV+i/6YWSzkz3V" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin="anonymous" />

    
      
      
      <link rel="stylesheet" href="https://utopizza.github.io/css/coder.min.a4f332213a21ce8eb521670c614470c58923aaaf385e2a73982c31dd7642decb.css" integrity="sha256-pPMyITohzo61IWcMYURwxYkjqq84XipzmCwx3XZC3ss=" crossorigin="anonymous" media="screen" />
    

    

    
      
        
        
        <link rel="stylesheet" href="https://utopizza.github.io/css/coder-dark.min.e78e80fc3a585a4d1c8fc7f58623b6ff852411e38431a9cd1792877ecaa160f6.css" integrity="sha256-546A/DpYWk0cj8f1hiO2/4UkEeOEManNF5KHfsqhYPY=" crossorigin="anonymous" media="screen" />
      
    

    

    

    <link rel="icon" type="image/png" href="https://utopizza.github.io/images/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="https://utopizza.github.io/images/favicon-16x16.png" sizes="16x16">

    <meta name="generator" content="Hugo 0.69.2" />
  </head>

  
  
    
  
  <body class="colorscheme-auto">
    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="https://utopizza.github.io/">
      Utopizza
    </a>
    
    <input type="checkbox" id="menu-toggle" />
    <label class="menu-button float-right" for="menu-toggle"><i class="fas fa-bars"></i></label>
    <ul class="navigation-list">
      
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://utopizza.github.io/about/">About</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://utopizza.github.io/posts/">Blog</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://utopizza.github.io/projects/">Projects</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://utopizza.github.io/contact/">Contact me</a>
          </li>
        
      
      
    </ul>
    
  </section>
</nav>


      <div class="content">
        
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">技术笔记(9)-MySql语法小结</h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fas fa-calendar"></i>
              <time datetime='2014-12-28T18:44:00Z'>
                December 28, 2014
              </time>
            </span>
            <span class="reading-time">
              <i class="fas fa-clock"></i>
              4-minute read
            </span>
          </div>
          <div class="categories">
  <i class="fas fa-folder"></i>
    <a href="https://utopizza.github.io/categories/technology/">Technology</a></div>

          
        </div>
      </header>

      <div>
        
        <p>一、数据库</p>
<p>1.数据库的选定</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">use testDB;
</code></pre></div><p>2.数据库的创建（后面两个是设置字符集和排序方式）：</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">create database(if not exist) testDB (character set charset)(collate collation);
</code></pre></div><p>3.数据库的删除：</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">drop database testDB;
</code></pre></div><p>4.数据库的更变：</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">alter database testDB(character set charset)(collate collation);
</code></pre></div><p>二、数据表</p>
<p>1.存储引擎（查看存储引擎：show engines）：</p>
<ul>
<li>ARCHIVE——插入</li>
<li>BLACKHOLE——删除</li>
<li>EXAMPLE——示例</li>
<li>Falcon——事务</li>
<li>FEDERATED——访问远程数据</li>
<li>InnoDB——外键</li>
<li>MEMORY——内存数据表</li>
<li>MERGE——联合</li>
<li>MyISAM——默认</li>
<li>NDB——MySQL</li>
<li>Cluster专用</li>
<li>CSV——使用逗号分隔数据项</li>
</ul>
<p>2.数据表的创建：</p>
<p>(1).数据表选项（选择存储引擎，否则默认为MyISAM）：</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">create table testTB( ... ) engine=InnoDB;
</code></pre></div><p>(2).创建全新的数据表：</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">create table if not exist testTB( ... ) engine=InnoDB;
</code></pre></div><p>(3).创建临时数据表：</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">create temporary table testTB( ... )
</code></pre></div><p>(4).使用查询结果或者其它数据表创建数据表：</p>
<p>i.如果要确保新表和原表的数据列的属性、索引都完全一致：</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">create table testTB like exampleTB;
insert into testTB select * from exampleTB;
</code></pre></div><p>ii.如果只要保证列名和数据一致，不需复制数据列的属性和索引：</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">create table testTB select * from exampleTB;
</code></pre></div><p>iii.为了弥补上一点，可以使用cast()函数强制使用特定的属性：</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">create table ... select cast(... as int) as ... , cast(... as char) as ... ;
</code></pre></div><p>(5).使用MERGE数据表，设置插入方式（要联合的表必须是结构完全一致的MyISAM数据表）：</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">create table test_4( ... )  engine=MERGE union=(test_1,test_2,test_3)  insert_method=last;
</code></pre></div><p>(6).使用分区数据表：</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">create table testTB
(
   id int not null,
   name varchar(20) null
)
partition by range(id)
(
   partition p1 values less than 10,
   partition p2 values less than 20,
   partition p3 values less than 30,
   partition p4 values less than 40,
   partition p5 values less than MAXVALUE,
);
</code></pre></div><p>(7).使用federated数据表：</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">create table federated_testDB( ... )  
engine=FEDERATED  
connection=&#39;mysql://wys:79135QW@hostname/testDB/testTB&#39;;
</code></pre></div><p>为了避免暴露连接字符串中的信息，可以：</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">create server testDB_server
foreign data wrapper mysql
options
(
  user &#39;wys&#39;
  password &#39;79135qw&#39;
  host &#39;...&#39;
  database &#39;testDB&#39;
);

create table federated_testTB( ... ) 
engine=FEDERATED
connection=&#39;testDB_server/testTB&#39;
</code></pre></div><p>3.数据表的删除：</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">drop table if exist testTB;
</code></pre></div><p>4.数据表的索引：</p>
<p>(1).创建索引：</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">// 在create内部
create table testTB( 
id int auto_increment primary key not null,
...
index index_name(id),...auto 
);

// 或者在create外部
create table testTB(...);
alter table testTB add index_name(id);
</code></pre></div><p>(2).删除索引：</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">drop index index_name on testTB; 
//或者 
alter table testTB drop index index_name;
</code></pre></div><p>5.改变数据表的结构：</p>
<p>(1).改变数据列的类型：</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">alter table testTB modify id varchar(100); 
// 或者 
alter table testTB change id id_newname varchar(100);
</code></pre></div><p>(2).改变存储引擎：</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">alter table testTB engine=InnoDB;
</code></pre></div><p>(3).重新命名数据表：</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">alter table testTB RENAME TO new_testTB;
</code></pre></div><p>(4).把一个数据表从一个数据库移动到另一个数据库：</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">rename table testDB.testTB to testDB_2.testDB
</code></pre></div><p>三、数据检索</p>
<p>1.获取数据库的元数据（各种show）：</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">show database;
show tables from ...;
show colums from ... like ...;
</code></pre></div><p>2.利用联结操作对多表进行检索：</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">select ... from ...
inner/left/right/cross join ... on ...=...
where ...
group by ...
order by ...
having ...
limit ...
</code></pre></div><p>3.使用子查询对多表进行检索：</p>
<p>(1).in和not in：是否存在或者不存在子查询中
(2).all和any和some：all所有；any任何一个；some和any等价
(3).exist和not exist：判断子查询是否有结果集</p>
<p>4.使用union对多表进行检索：</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">(select ... from ...) 
union 
(select ... from ...) 
union 
(select ... from ...) 
...
</code></pre></div><p>5.使用视图（可用视图完成一些必要的数学运算）：</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">ctreate view testView as select ... from ...
</code></pre></div><p>6.涉及多个数据表的删除和更新操作</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">//删除表t1中id与表t2匹配的行
delete t1 from t1 inner join t2 on t1.id=t2.id;

// 删除表t1中id不与表t2匹配的行
delete t1 from t1 left join t2 on t1.id=t2.id where t2.id is null;

//同时删除表t1和表t2中id匹配的行
delete t1,t2 from t1 inner join t2 on t1.id=t2.id;

// 或者使用using
delete from t1 using t1 inner join t2 on t1.id=t2.id;
delete from t1 using t1 left join t2 on t1.id=t2.id where t2.id is null;
delete from t1,t2 using t1 inner join t2 on t1.id=t2.id;
</code></pre></div><p>四、事务处理（需要使用的存储引擎是InnoDB或者Falcon）</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">start transaction; // 或者set autocommit=0
insert into ...
delete from ...
commit; // set autocommit=1; 对应于上面的括号内的语句
</code></pre></div><p>1.事务的特点：</p>
<ul>
<li>a.原子性，事务内容要么全部成功，要么全部失败</li>
<li>b.隔离性，事务之间是隔离的，比如在某事务向数据库插入一些数据的时候，如果事务还没结束，即使某些数据已经插入去了，但是这些数据对其他所有用户是不可见的，直到事务完成提交</li>
<li>c.稳定性，数据在事务开始和结束后都是稳定的状态</li>
<li>d.可靠性，如果事务执行成功，它的影响将被永久保存到数据库</li>
</ul>
<p>2.备注：在默认的情况下，MySQL从自动提交（autocommit）模式运行，这种模式会在每条语句执行完毕后把它当做一个事务进行提交，如果使用了 <code>set autocommit=0</code> 语句后，这个自动提交将被禁止，这样的结果是，除非遇到一些显式提交语句（如：commit，rollback&hellip;），或者隐式提交前一个事务，然后在本语句重新开始事务的DLL语句（如：alter table，create index，drop database，drop index&hellip;），系统会认为接下来的所有的语句都属于一个事务</p>
<p>3.使用事务保存点：使事务部分回滚</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">create table testTable(id int) engine=InnoDB;
start transaction;
insert into testTable(id) values(1);
SAVEPOINT my_savepoint;
insert into testTable(id) values(2);
rollback to SAVEPOINT my_savepoint;
insert into testTable(id) values(3);
commit;
select * from testTable;
// 此时表中的数据只有1和3，因为2被rollback了
</code></pre></div><p>4.事务的隔离性：InnoDB存储引擎提供4种隔离级别：</p>
<ul>
<li>read uncommited——允许某个事务看到其他事务尚未提交的数据改动 read</li>
<li>commited——只允许某个事务看到其他事务已经提交的数据改动 repeatable</li>
<li>read（默认级别）——即使在本事务进行中，有其他事务在同时修改了数据行，本事务每次执行同一个select的结果不变</li>
<li>serializable——更彻底的隔离，如果某个事务正在读取某些数据行，那么在它完成之前，其他事务对这些数据行不可改动</li>
</ul>
<p>修改级别：</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">set global transaction isolation level ...;（全局有效）
set sessoin transaction isolation level ...;（本次会话有效）
set transaction isolation level ...;（下一次事务有效）
</code></pre></div><p>5.事务问题的非事务解决方案：</p>
<p>a.明确的锁定数据表</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">LOCK tables testTable write;
select ... from ...;
update ... set ...;
UNLOCK tables;
</code></pre></div><p>b.使用相对更新操作，不使用绝对更新操作（即在一个语句中，使用当前值进行差额修改的方法，而不是直接设置为一个绝对值）</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">update ... set ... = ... + ... where ... 
</code></pre></div><p>五、外键的创建和使用</p>
<p>1.语法</p>
<p>2.InnoDB存储引擎目前只能识别和支持以下外键定义语法</p>
<p>1).constraint：用来给外键约束起一个名字
2).foreign key：列出子表的被索引数据列
3).references：列出父表和父表中的被索引数据列
4).on delete：用来设定父表里的数据行被删除时，子表中对应的数据应该发生什么事件，其子句可选择如下：</p>
<ul>
<li>on delete (no action) restrict：拒绝在父表里删除那些与子表仍有数据关联的数据行（默认）</li>
<li>on delete cascade：删除父表数据行时，子表里相关的数据行也被删除</li>
<li>on delete set null：删除父表数据行时，子表里相关的数据行的索引列将被设置为NULL（隐含着外键不能定义为主键的意思，因为主键不能为NULL）</li>
</ul>
<p>5).on update：同delete</p>
<p>六、使用FULLTEXT索引</p>
<p>七、存储过程</p>
<p>1.复合语句和语句分隔符：使用复合语句的时候，必须先使用delimiter命令把mysql程序的语句分隔符重定义为另一个字符或字符串，它必须是存储例程里没有定义过的。在定义完了存储过程之后，切记把mysql程序的语句终止符重定义为分号</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">delimiter $（或者字符串asdfs，erer等等都可以）
create procedure test()
begin
   select ... from ... ;
end $
delimiter ;
call test();
</code></pre></div><p>2.存储函数（只能有一个返回值）</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">delimiter $
create function test_function(id int)
returns int
reads sql data
begin
    return (select ... from ... where ...=id);
end $
delimiter ;
</code></pre></div><p>3.存储过程（返回结果集）。和存储函数不同，存储过程不能使用在表达式里，只能通过CALL语句来调用：call test_procedure(100);
另外，存储函数不允许对调用本函数的语句正在读或写的数据表进行修改，存储过程没有这个限制，但是如果它们是从存储函数里被调用，就也需要遵守这个规则</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">delimiter $
create procedure test_procedure(id int)
begin
    select ... from ... where ...&gt;=id;
end $
delimiter ;
</code></pre></div><p>4.存储过程的参数类型（在参数名前说明）</p>
<ul>
<li>in参数：输入的参数（默认）</li>
<li>out参数：输出的参数（需在过程中设置变量）</li>
<li>inout参数：输入一个值然后再输入一个值（需在过程中设置变量）</li>
</ul>
<p>八、触发器（触发器是与特定数据表相关联的存储过程，当相应的数据表被insert，delete，或者update语句修改时就会自动执行）</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">delimiter $
create trigger test_trigger before(after) insert on testTable
    for each row begin
        if NEW.col_name(OLD.col_name) then ... ;
        end if;
    end $
delimiter ;
</code></pre></div><p>九、事件（定时执行预设好的数据库操作，和SQL SERVER中的作业相当）</p>
<p>1.启用（停止）事件调度器：</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">set event_scheduler=on（off）
</code></pre></div><p>2.查看：</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">show variables like &#39;event_scheduler&#39; ;
</code></pre></div><p>3.创建：</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">create event test_event  on schedule every 4 hour
do 
delete from testTable where ...
</code></pre></div><p>4.禁用或者开启某个事件</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">alter event test_Event disable;
alter event test_Event enable;
</code></pre></div><p>十、关于建表：</p>
<ul>
<li>enum(&lsquo;F&rsquo;,&lsquo;M&rsquo;)：该字段只能是F或M的枚举类型</li>
<li>unsigned：不允许出现负数</li>
<li>auto_increment：自增</li>
<li>primary key(student_id)：指定主键</li>
<li>foreign key(score_id) references - - ScoreTable(score_id)：指定外键（一般外键是其他某个表的主键）</li>
<li>index(student_id)：指定索引</li>
<li>engine=InnoDB：选择数据引擎为InnoDB，该引擎允许外键的使用</li>
</ul>
<p>十一、语法：</p>
<p>1.NULL是无数据，或未知数据，不能使用=，&lt;&gt;，！=来进行比较，只能用 is null 或者 is not null</p>
<p>2.升序排列asc，降序排列desc</p>
<p>3.设置查询显示的行数：order by &hellip; desc limit 5;</p>
<p>4.随机抽取3条数据：order by RAND() limit 3</p>
<p>十二、模式匹配：
like，not like，%，_</p>
<p>十三、设置和使用SQL变量：</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">select @studentName:=name from studentTable where id=1
set @studentName=&#39;abc&#39;
</code></pre></div>
      </div>


      <footer>
        


        
        
        
      </footer>
    </article>

    
  </section>

      </div>

      <script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

    </main>

    

    

    <script>
(function(f, a, t, h, o, m){
	a[h]=a[h]||function(){
		(a[h].q=a[h].q||[]).push(arguments)
	};
	o=f.createElement('script'),
	m=f.getElementsByTagName('script')[0];
	o.async=1; o.src=t; o.id='fathom-script';
	m.parentNode.insertBefore(o,m)
})(document, window, '//analytics.example.com/tracker.js', 'fathom');
fathom('set', 'siteId', 'ABCDE');
fathom('trackPageview');
</script>


  </body>

</html>
